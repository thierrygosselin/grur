<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate RADseq data — simulate_rad • grur</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate RADseq data — simulate_rad" />
<meta property="og:description" content="Simulate populations of RADseq data following island or stepping 
stone models.
Inside the function, allele frequency can be created with
fastsimcoal2 and then used
inside rmetasim simulation engine.
The function requires strataG
to be installed." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">grur</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">Installation</a>
</li>
<li>
  <a href="https://thierrygosselin.github.io/grur/#assumptions-before-imputing-your-dataset">Assumptions</a>
</li>
<li>
  <a href="https://thierrygosselin.github.io/grur/#features">Features</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/rad_genomics_computer_setup.html">Computer setup - Installation - Troubleshooting</a>
    </li>
    <li>
      <a href="../articles/vignette_missing_data_analysis.html">Missing visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thierrygosselin/grur">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate RADseq data</h1>
    <small class="dont-index">Source: <a href='https://github.com/thierrygosselin/grur/blob/master/R/simulate_rad.R'><code>R/simulate_rad.R</code></a></small>
    <div class="hidden name"><code>simulate_rad.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate populations of RADseq data following island or stepping 
stone models.
Inside the function, allele frequency can be created with
<a href='http://cmpg.unibe.ch/software/fastsimcoal2/'>fastsimcoal2</a> and then used
inside <a href='https://github.com/stranda/rmetasim'>rmetasim</a> simulation engine.
The function requires <a href='https://github.com/EricArcher/strataG'>strataG</a>
to be installed.</p>
    </div>

    <pre class="usage"><span class='fu'>simulate_rad</span>(
  num.pops = <span class='fl'>5</span>,
  num.loci = <span class='fl'>1000</span>,
  div.time = <span class='fl'>25000</span>,
  ne = <span class='fl'>50</span>,
  nm = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>5</span>),
  theta = <span class='fl'>0.2</span>,
  mig.type = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"island"</span>, <span class='st'>"stepping.stone"</span>),
  num.reps = <span class='fl'>10</span>,
  num.rms.gens = <span class='fl'>10</span>,
  label = <span class='kw'>NULL</span>,
  fsc.exec = <span class='st'>"fsc26"</span>,
  parallel.core = <span class='kw'>parallel</span>::<span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span>() <span class='op'>-</span> <span class='fl'>1</span>,
  use.wd = <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>num.pops</th>
      <td><p>(integer) Number of populations.
Default: <code>num.pops = 5</code>.</p></td>
    </tr>
    <tr>
      <th>num.loci</th>
      <td><p>(integer) Number of independent RADseq loci.
To use more than 2000 loci, <span class="pkg">rmetasim</span> needs to be modified
(<a href='https://github.com/thierrygosselin/grur/blob/master/vignettes/vignette_grur.Rmd'>vignette</a>).
Default: <code>num.loci = 1000</code>.</p></td>
    </tr>
    <tr>
      <th>div.time</th>
      <td><p>(integer) Time since divergence of populations.
Default: <code>div.time = 25000</code>.</p></td>
    </tr>
    <tr>
      <th>ne</th>
      <td><p>(integer) Effective populations size.
Default: <code>ne = c(50, 500)</code>.</p></td>
    </tr>
    <tr>
      <th>nm</th>
      <td><p>(integer) Number of migrants per generation.
Default: <code>nm = c(0, 0.1, 0.5, 1, 5)</code>.</p></td>
    </tr>
    <tr>
      <th>theta</th>
      <td><p>(integer) Value of theta (= ne * migration rate).
Default: <code>theta = 0.2</code>.</p></td>
    </tr>
    <tr>
      <th>mig.type</th>
      <td><p>(integer) Migration topology type: <code>"island"</code> or 
<code>"stepping.stone"</code>.</p></td>
    </tr>
    <tr>
      <th>num.reps</th>
      <td><p>(integer) Number of replicates for each scenario.
Default: <code>num.reps = 10</code>.</p></td>
    </tr>
    <tr>
      <th>num.rms.gens</th>
      <td><p>(integer) Number of <code>rmetasim</code> generations to establish
linkage disequilibrium.
Default: <code>num.rms.gens = 10</code>.</p></td>
    </tr>
    <tr>
      <th>label</th>
      <td><p>(integer) Label for the output folder. With default <code>label = NULL</code>,
the label will be "<code>sim.results.YYYYMMDD.HHMM</code>".</p></td>
    </tr>
    <tr>
      <th>fsc.exec</th>
      <td><p>(character) Name of fastsimcoal executable. See details.
Default: <code>fsc.exec = "fsc26"</code> (for latest version: v.2.6.0.3 - 14.10.17)</p></td>
    </tr>
    <tr>
      <th>parallel.core</th>
      <td><p>(optional, integer) The number of core used for parallel
execution.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></td>
    </tr>
    <tr>
      <th>use.wd</th>
      <td><p>(optional, logical) Use the working directory for output files? 
Default: <code>use.wd = FALSE</code> means that files are written to temporary folder.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>invisibly, a list containing the parameters used to run the 
  simulation and the filenames of the genotypes for each scenario
  and replicate</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><strong>fastsimcoal2: </strong>
 The function requires that the executable for 
 <a href='http://cmpg.unibe.ch/software/fastsimcoal2/'>fastsimcoal</a> be installed 
 in a location where it can be executed from the current working directory.</p> 
<p><a href='http://gbs-cloud-tutorial.readthedocs.io/en/latest/03_computer_setup.html?highlight=PATH#save-time'>How to set up your PATH</a>.</p> 
<p><a href='http://gbs-cloud-tutorial.readthedocs.io/en/latest/07_start_from_new_image.html#install-gbs-radseq-software-time-required-30min'>How to install fastsimcoal2 v.2.6.0.3</a></p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The following arguments can be specified as single values or vectors:
 <code>num.pops, num.loci, div.time, ne, nm, theta, mig.type</code>. One simulation 
 scenario will be generated for each combination of unique values of these 
 arguments.</p> 
 
<p>The function will create a folder in the current working directory with the 
 name provided by <code>label</code>. Within this folder there will be an R 
 workspace file ("<code>scenarios.rdata</code>") containing a data frame with the 
 parameters for each scenario (<code>scenarios</code>), and one R  
 workspace file for each scenario, named <code>"gtypes.#.rdata"</code> where "#" 
 is the scenario number. Each scenario file contains a list named 
 <code>sim.data</code>, which contains a <code><a href='https://rdrr.io/pkg/strataG/man/gtypes-class.html'>strataG::gtypes</a></code> representation 
 of the simulated SNP data for every replicate in that scenario. The list 
 has a "<code>scenario</code>" attribute which is a one row data.frame providing 
 the parameters that generated the data and a "<code>label</code>" attribute which 
 is the label of the set of scenarios that were run.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://github.com/EricArcher/strataG'>strataG</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Eric Archer <a href='mailto:eric.archer@noaa.gov'>eric.archer@noaa.gov</a> and 
  Thierry Gosselin <a href='mailto:thierrygosselin@icloud.com'>thierrygosselin@icloud.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'><a href='https://github.com/thierrygosselin/grur'>grur</a></span>)
<span class='kw'>sim</span> <span class='op'>&lt;-</span> <span class='kw'>grur</span>::<span class='fu'>simulate_rad</span>(
  num.pops = <span class='fl'>3</span>, 
  num.loci = <span class='fl'>200</span>, 
  div.time = <span class='fl'>1000</span>, 
  ne = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>,<span class='fl'>200</span>),
  nm = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>0.1</span>), 
  theta = <span class='fl'>0.2</span>, 
  mig.type = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"island"</span>, <span class='st'>"stepping.stone"</span>), 
  num.reps = <span class='fl'>3</span>,
  num.rms.gens = <span class='fl'>5</span>,
  label = <span class='kw'>NULL</span>, 
  fsc.exec = <span class='st'>"fsc26"</span>, 
  parallel.core = <span class='fl'>4</span>
 )
}
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thierry Gosselin, Eric Archer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


